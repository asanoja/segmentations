<!doctype html>
<html lang="us">
<head>
	<meta charset="utf-8">
	<title>Block-o-Matic Web Page Segmentation Algorithm</title>
	<link href="css/ui-lightness/jquery-ui-1.10.3.custom.css" rel="stylesheet">
	<link rel='stylesheet' type='text/css' href='css/xmltree.css' />
	<script src="js/jquery-1.9.1.js"></script>
	<script src="js/jquery-ui-1.10.3.custom.js"></script>
	<script src='js/xmltree.js'></script>
	<script>
	var process=false;
	var prog=0;
	
	$(function() {
		
		$( "#accordion" ).accordion({
		  heightStyle: "content"
		});
		

		
		var availableTags = [
			"ActionScript",
			"AppleScript",
			"Asp",
			"BASIC",
			"C",
			"C++",
			"Clojure",
			"COBOL",
			"ColdFusion",
			"Erlang",
			"Fortran",
			"Groovy",
			"Haskell",
			"Java",
			"JavaScript",
			"Lisp",
			"Perl",
			"PHP",
			"Python",
			"Ruby",
			"Scala",
			"Scheme"
		];
		$( "#autocomplete" ).autocomplete({
			source: availableTags
		});
		

		
		$( "#btngo" ).button();
		$( "#radioset" ).buttonset();
		

		
		$( "#tabs" ).tabs();
		

		
		$( "#dialog" ).dialog({
			autoOpen: false,
			width: 400,
			buttons: [
				{
					text: "Ok",
					click: function() {
						$( this ).dialog( "close" );
					}
				},
				{
					text: "Cancel",
					click: function() {
						$( this ).dialog( "close" );
					}
				}
			]
		});

		// Link to open the dialog
		$( "#dialog-link" ).click(function( event ) {
			$( "#dialog" ).dialog( "open" );
			event.preventDefault();
		});
		

		
		$( "#datepicker" ).datepicker({
			inline: true
		});
		

		
		$( "#slider" ).slider({
			range: false,
			max:  10,
			change: function( event, ui ) { 
				$(this).find("a:first").text(ui.value) / 100;
			}
		});
		

		
		$( "#progressbar" ).progressbar({
			value: 0,
			max: 4
		});
		

		// Hover states on the static widgets
		$( "#dialog-link, #icons li" ).hover(
			function() {
				$( this ).addClass( "ui-state-hover" );
			},
			function() {
				$( this ).removeClass( "ui-state-hover" );
			}
		);
	});
	
	function segment() {
		process = true;
		$('#progressbartext').html("");
		$('#mycontent').html("");
		prog=0;
		advance("Starting with page capture...")
		callbom("capture");
	}
	
	function callbom(cmd) {
		initiate();
		if (cmd=='capture') {
			purl=$("#srcurl").val();
			if ($('#firefox').is(':checked')) browser="firefox";
			if ($('#chrome').is(':checked')) browser="chrome";
			granularity = $("#granularity").val();
			console.log("calling capture for "+purl);
			$.ajax({
					type: "GET",
					url : "call_bom.php",
					data: "cmd="+cmd+"&purl="+purl+"&browser="+browser+"&granularity="+granularity,
					dataType: "text",
					success : function(data) {
						console.log("return "+data);
						code = data.split(":")[0]
						time = data.split(":")[1]
						if (process && code=="OK") {
							advance("Page captured correctly in "+time+"<br>Now segmenting page...");
							callbom("analyze");
						}
					}
			});
		}
		
		if (cmd=='analyze') {
			purl=$("#srcurl").val();
			if ($('#firefox').is(':checked')) browser="firefox";
			if ($('#chrome').is(':checked')) browser="chrome";
			granularity = $("#granularity").val();
			$.ajax({
					type: "GET",
					url : "call_bom.php",
					data: "cmd="+cmd+"&purl="+purl+"&browser="+browser+"&granularity="+granularity,
					dataType: "text",
					success : function(data) {
						console.log("return "+data);
						code = data.split(":")[0]
						time = data.split(":")[1]
						if (process && code=="OK") {
							advance("Segmented done in "+time+"<br>Now generating output page...");
							callbom("view");
						}
					}
			});
		}
		
		if (cmd=='view') {
			purl=$("#srcurl").val();
			if ($('#firefox').is(':checked')) browser="firefox";
			if ($('#chrome').is(':checked')) browser="chrome";
			granularity = $("#granularity").val();
			$.ajax({
					type: "GET",
					url : "call_bom.php",
					data: "cmd="+cmd+"&purl="+purl+"&browser="+browser+"&granularity="+granularity,
					dataType: "text",
					success : function(data) {
						console.log("return "+data);
						code = data.split(":")[0]
						time = data.split(":")[1]
						if (process && code=="OK") {
							msg="Output generated in "+time+".\n<br>Done!<br>View results as ";
							msg+="[<a href='call_bom.php?cmd=xml&purl="+purl+"&browser="+browser+"&granularity="+granularity+"' target='_blank'>ViXML</a>]&nbsp;";
							msg+="[<a href='call_bom.php?cmd=html&purl="+purl+"&browser="+browser+"&granularity="+granularity+"' target='_blank'>HTML w/blocks</a>]&nbsp;";
							msg+="[<a href='call_bom.php?cmd=screenshot&purl="+purl+"&browser="+browser+"&granularity="+granularity+"' target='_blank'>PNG (Screenshot)</a>]";
							advance(msg);
							//callbom("xml");
							process=false;
						}
					}
			});
		}
		
		if (cmd=='xml') {	
			purl=$("#srcurl").val();
			if ($('#firefox').is(':checked')) browser="firefox";
			if ($('#chrome').is(':checked')) browser="chrome";
			granularity = $("#granularity").val();
			$(function() { new XMLTree({
				fpath: "call_bom.php?browser="+browser+"&cmd="+cmd+"&purl="+purl+"&granularity="+granularity, 
				container: '#mycontent', 
				startCollapsed: false
				}); 
			});	
		}
		
		
		if (cmd=='whtml') {
			$.ajax({url:"call_bom.php?browser="+browser+"&cmd=whtml&url="+url,success:function(result){
				$("#tabs-2").html(result);
			}});
		}
	}
	
	function initiate() {
	}
	
	function advance(msg) {
		prog++;
		$("#progressbar").progressbar( "option", "value",  prog);
		$('#progressbartext').html($('#progressbartext').html()+msg+"<br>");
	}
	
	function terminate() {
	}
	 
	</script>
	<style>
	body{
		font: 62.5% "Trebuchet MS", sans-serif;
		margin: 50px;
	}
	.demoHeaders {
		margin-top: 2em;
	}
	
	#accordion {
		font-size:1.5em;
	}
	
	#dialog-link {
		padding: .4em 1em .4em 20px;
		text-decoration: none;
		position: relative;
	}
	#dialog-link span.ui-icon {
		margin: 0 5px 0 0;
		position: absolute;
		left: .2em;
		top: 50%;
		margin-top: -8px;
	}
	#icons {
		margin: 0;
		padding: 0;
	}
	#icons li {
		margin: 2px;
		position: relative;
		padding: 4px 0;
		cursor: pointer;
		float: left;
		list-style: none;
	}
	#icons span.ui-icon {
		float: left;
		margin: 0 4px;
	}
	.fakewindowcontain .ui-widget-overlay {
		position: absolute;
	}
	</style>
</head>
<body>

<table>
	<tr><td>
<span style="font-size:42px;color:#D7D740;background-color:#7F00FF">B</span><span style="font-size:42px;color:blue;background-color:#FF7F00">o</span><span style="font-size:42px;color:red;background-color:#007FFF">M!</span> <br>
</td>
<td>
<h1>Block-o-Matic! (Beta)</h1>
<b>a Web Page Segmentation Algorithm</b>
</td>
</tr>
</table>
<div id="accordion">
	<h3>Get it:</h3>
	<div>
			<h2>Release 1.0.0</h2>
<table>
	<tr>
		<td><img src="images/chrome.png" width="32"></a></td>
		<td>BoM chrome extension</td>
		<td> <a href="BOM/BOM.crx">[download]</td>
	</tr>
</table>
<h2>Installation Instruction</h2>
<ol>
<li>Download .crx file to your computer</li>
<li>Open a new Chrome browser window and write in the url bar <pre>chrome://extensions</pre></li>
<li>Drag &amp; Drop both files to this new window</li>
<li>Click 'Add'</li>
<li>Done. Happy BOM!</li>
</ol>
	</div>
	<h3>About</h3>
	<div class="ui-widget">
		<h2>About the DEMO</h2>
		<a href="content" target="_blank">Demo Info</a>
		<h2>Abstract</h2>
		<p>
		In this paper we describe Block-o-Matic, a web page segmentation algorithm. It is based on an hybrid approach for scanned document segmentation and visual-based content segmentation. A web page is associated with three structures: the DOM tree, the content structure and the logical structure. The DOM tree represents the HTML elements of a page, the geometric structure organizes the content based on a category and its geometry and finally the logical structure is the result of mapping content structure on the basis of the human-perceptible meaning that conforms the blocks. The segmentation process is divided in three phases: analysis, understanding and reconstruction of a web page. An evaluation method is proposed in order to perform the evaluation of web page segmentations based on a ground truth of 400 pages classified into 16 categories. A set of metrics are presented based on geometric properties of blocks. Satisfactory results are reached when comparing to other algorithms following the same approach
		</p>
		<h2>Block-o-Matic Web Page Segmentation Model</h2>
		<p>We extend the concepts of [4], a model for segmenting digitized document in the optical character
			recognition domain, and adapt it to web pages. The content structure is the DOM interface after rendering
			a page in a browser. The geometric structure describes a page with respect to the geometric properties of
			content elements. The logical structure describes the connections of blocks at a layout level. For example
			if a logical block is found at top of page and the next in the bottom, that suggests a vertical layout flow.
			As shown in Figure 1, the segmentation process of a page (W) is divided into three phases: page analysis,
			page understanding and page reconstruction. The extraction of the geometric structure (Wgeom) from the
			content structure (Wcont) is called web page analysis (c2g function). Mapping the geometric structure
			(Wgeom) into a logical structure (Wlog) is called document understanding (g2l function). Rebuilding the
			web page from the logic (Wlog), geometric (Wgeo) and content structure (Wcont) is called web page
			reconstruction (Rec function) where, W= Rec(W cont , c2g(Wcont), g2l(c2g(Wcont))). The c2g function
			â€²
			constructs the geometric structure from the content structure. It organizes the content in function of the
			tag as: content, container, content-container or default elements. Additionally, it checks that there are not
			overlapping between siblings blocks. The g2l function constructs the logic structure from geometric
			structure. It assigns labels to geometrics blocks depending on their position in the web page, the relative
			area they occupy and the visual cues of their content elements. The labels are: left, right, top, bottom,
			middle or in other case standard. The Rec function builds the page (W') which is the original document
			(W) enriched with all structure, into an linear document in a XML-like style.<br>

	<center><img src="images/fig1.png" width="800"></center>
		</p>
		</p>
	</div>

<h3>References</h3>
<ol>
<li>Deng Cai, Shipeng Yu, Ji-Rong Wen, and Wei-Ying Ma. Extracting content structure for web pages based on visual</li>
representation. In Fifth Asia Pacific Web Conference (APWeb'03), 2003.</li>
<li>Jisheng Liang, Ihsin T. Phillips, and Robert M. Haralick. Performance evaluation of document structure extraction
algorithms. Computer Vision and Image Understanding, 84(1):144-159, 2001.</li>
<li>Zeynep Pehlivan, Myriam Ben-Saad, and StÃ©phane GanÃ§arski. Vi-diff: understanding web pages changes. In Proceedings of
the 21st international conference on Database and expert systems applications: Part I, DEXA'10, pages 1-15, Berlin,
Heidelberg, 2010. Springer-Verlag.</li>
<li>Y.Y. Tang, C. Y. Suen, C. D. Yan, and M Cheriet. Document analysis and understanding: a brief survey. First International
Conference on Document Analysis and Recognition, pages 17-31, 1991.</li>
<li>Yeliz Yesilada. Web page segmentation: A review. Technical report, Middle East Technical University Northern Cyprus
Campus, March 2011.</li>
<li>https://github.com/openplanets/pagelyzer</li>
<li>
Faisal Shafait, Daniel Keysers, Thomas Breuel, "Performance Evaluation and Benchmarking of Six-Page Segmentation Algorithms," IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. 30, no. 6, pp. 941-954, June, 
</li>
</ol>
</body>
</html>

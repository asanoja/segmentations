<html>
	<head>
		<title>G|T Segmentations Evaluation</title>
	</head>
<!-- global script -->
<script src="rectlib.js"></script>
<script>

var contentDocument;
var topDocument;
var contentWindow;
var topWindow;
var evalWindow;
var evalDocument;

var drawings = [];
var dataloaded = 0;

var batchmode = false;

function debug(data) {topWindow.add2log(data)}

function add2(struc,level,data,events) {
	topWindow.add2struc(struc,level,data,events)
}

window.onload = function() {
        topWindow 		= window.frames[0];
        topDocument 	= topWindow.document;
        
        evalWindow 		= window.frames[5];
        evalDocument 	= evalWindow.document;
        
        topWindow.loadURLS();
        //~ contentWindow 	= window.frames[1];
        //~ contentDocument = contentWindow.document;
        //startSegmentation();
};

function startFilter() {
	var url = topDocument.getElementById('gturl').value;
	var leftseg = topDocument.getElementById('left_algorithm').value;
	var rightseg = topDocument.getElementById('right_algorithm').value;
	var left_browser = topDocument.getElementById('left_browser').value;
	var right_browser = topDocument.getElementById('right_browser').value;
	setSegmentation(leftseg,rightseg,left_browser,right_browser,url);
	//~ document.getElementById("gtfilter").src = "http://www-poleia.lip6.fr/~sanojaa/BOM/data.php?source=GTdata&filter="+encodeURIComponent(url)+"&browser="+browser;
	//~ document.getElementById("segfilter").src = "http://www-poleia.lip6.fr/~sanojaa/BOM/data.php?source="+xseg+"&filter="+encodeURIComponent(url)+"&browser="+browser;
}

function prepareEvaluation() {
	//~ document.getElementById("gtview").src = "about:blank";
	//~ document.getElementById("segview").src = "about:blank";
	evalWindow.clearDivsIn(parent.frames[2].document);
	evalWindow.clearDivsIn(parent.frames[4].document);
	if (evalWindow.prepareEvaluation(topDocument.getElementById('gturl').value)) {
		evalWindow.draw(evalWindow.e.gt,parent.frames[2]);
		evalWindow.draw(evalWindow.e.seg,parent.frames[4])
		return(true);
	}
	return(false);
}

function startEvaluation() {
	evalWindow.startEvaluation();
}

function setSegmentation(leftseg,rightseg,left_browser,right_browser,url) {
	document.getElementById("gtfilter").src = "http://www-poleia.lip6.fr/~sanojaa/BOM/data.php?source="+leftseg+"&filter="+encodeURIComponent(url)+"&browser="+left_browser;
	document.getElementById("segfilter").src = "http://www-poleia.lip6.fr/~sanojaa/BOM/data.php?source="+rightseg+"&filter="+encodeURIComponent(url)+"&browser="+right_browser;
}

function batch(urlind,algoind) {
	batchmode = true;
	topWindow.algoind = 1;
	topWindow.urlind = 1
	topWindow.browserind=0;
	topWindow.document.getElementById("left_algorithm").selectedIndex = 0; //first algorithm
	topWindow.document.getElementById("right_algorithm").selectedIndex = 1; //second algorithm
	topWindow.document.getElementById("right_browser").selectedIndex = 0; //first algorithm
	topWindow.processURL();
}

function dataLoaded() {
	dataloaded++;
	console.log("cargada data: "+dataloaded)
	if (dataloaded>1) {
		dataloaded=0;
		if (parent.batchmode) {
			if (topWindow) topWindow.step2();
		}
	}
}

function isURLPresent(url) {
	var filterdoc = window.frames[1].document;
	var elements = filterdoc.getElementsByTagName("td");
	for (var i=0;i<elements.length;i++) {
		if (elements[i].innerText.trim().toLowerCase() == url.trim().toLowerCase()) {
			return(true);
		}
	}
	return(false)
}
</script>

<frameset rows="20%,*,5%">
	<frame src='gttop.html' id='top' name='top'>
	<frameset cols="33%,33%,*">
		<frameset rows="33%,*">
			<frame id='gtfilter' name='gtdata' src='http://www-poleia.lip6.fr/~sanojaa/BOM/data.php?source=GTdata'/>
			<frame id='gtview' name='gtview' src='about:blank'/>
		</frameset>	
		<frameset rows="33%,*">
			<frame id='segfilter' name='segfilter' src='http://www-poleia.lip6.fr/~sanojaa/BOM/data.php?source=BOMdata'/>
			<frame id='segview' name='segview' src='about:blank'/>
		</frameset>	
		<frame id='evaluacion' name='evaluacion' src='evaluate.html'/>
	</frameset>
	<frame id='evalout' name='evalout' src='about:blank'/>
	
</frameset>
</html>
